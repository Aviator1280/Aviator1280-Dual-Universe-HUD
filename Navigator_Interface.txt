{"slots":{"0":{"name":"screen","type":{"events":[],"methods":[]}},"1":{"name":"databank","type":{"events":[],"methods":[]}},"2":{"name":"core","type":{"events":[],"methods":[]}},"3":{"name":"receiver","type":{"events":[],"methods":[]}},"4":{"name":"emitter","type":{"events":[],"methods":[]}},"5":{"name":"slot6","type":{"events":[],"methods":[]}},"6":{"name":"slot7","type":{"events":[],"methods":[]}},"7":{"name":"slot8","type":{"events":[],"methods":[]}},"8":{"name":"slot9","type":{"events":[],"methods":[]}},"9":{"name":"slot10","type":{"events":[],"methods":[]}},"-1":{"name":"unit","type":{"events":[],"methods":[]}},"-2":{"name":"system","type":{"events":[],"methods":[]}},"-3":{"name":"library","type":{"events":[],"methods":[]}}},"handlers":[{"code":"sgui:process(x,y)\n--system.print('mouse' .. x .. '-' ..y)","filter":{"args":[{"variable":"*"},{"variable":"*"}],"signature":"mouseUp(x,y)","slotKey":"0"},"key":"0"},{"code":"--CH BaseData\nmsg_counter = msg_counter + 1\n\nsystem.print(\"RECEIVED \"..msg_counter)\n\nmsg_received = true\n\nrcv_msg = message:gsub(\"@@@\",\"\\\"\")\nrcv_msg = json.decode(rcv_msg)\n\nreceiving_data()","filter":{"args":[{"value":"BaseData"},{"variable":"*"}],"signature":"receive(channel,message)","slotKey":"3"},"key":"1"},{"code":"--[[\n\nAuthor: Aviator1280\n\n--]]\n\n--LUA PARAMETERS\n\n    if (databank.getFloatValue(\"navigator_MTOW\") ~= 0) then\n        factory_MTOW = databank.getFloatValue(\"navigator_MTOW\")\n        new_MTOW = factory_MTOW/1000\n    else\n        factory_MTOW = 730000 --export\n        new_MTOW = factory_MTOW/1000\n    end\n\n    if (databank.getFloatValue(\"navigator_autobrake\") ~= 0) then\n        factory_autobrake = databank.getFloatValue(\"navigator_autobrake\")\n    else\n        factory_autobrake = 2.3 --export\n    end\n\n    factory_PE_target_altitude = 20000 --export\n\n    --DISPLAY COLORS\n        COLORS_Tables_Border = \"blue\" --export: keep the \" \"\n        COLORS_Table_Titles = \"yellow\" --export: keep the \" \"\n        COLORS_Tables_Text = \"white\" --export: keep the \" \"\n        COLORS_Measure_Units = \"aqua\" --export: keep the \" \"\n\n--CSS\n    function css_html()\n        local css = [[\n        <style>\n            td {\n                border:2px solid ]]..COLORS_Tables_Border..[[;\n                color:]]..COLORS_Tables_Text..[[;\n                font-family: Arial !important;\n                font-size:35px;\n                text-align:left;\n            }\n            .center {\n                text-align:center;\n            }\n            .px30 {\n                font-size:30px;\n            }\n            .yellow {\n                color:]]..COLORS_Table_Titles..[[;\n            }\n            .cyan {\n                color:]]..COLORS_Measure_Units..[[;\n            }\n            .red {\n                color:red;\n            }\n            .prog_bar {\n                background: yellow;\n            }\n        </style>]]\n        return css\n    end\n\n--SGUI MODIFIED\n    function SGui.createButtonArea(self, screen, x, y, hx, hy, text, fun)\n        COLORS_Buttons = \"blue\" --export: keep the \" \"\n        button = \"<div class='bootstrap' style='background:\"..COLORS_Buttons..\";width:\".. (hx*100) ..\n                \"vw;height:\" .. (hy*100) ..\"vh;overflow:hidden;font-family:ArialMT;font-size:\".. (hy*50) ..\n                \"vh;'>\" .. text .. \"</div>\"\n        id = screen.addContent(x * 100, y * 100, button)\n        self:createClickableArea(id, x, y, hx, hy, fun)\n        return id\n    end -- function SGui\n\n    function SGui.deleteClickableArea(self, id)\n        table[id] = nil\n    end\n\n    sgui = SGui.new()\n\n--ACTIVATE SCREEN\n    screen.activate()\n\n--STRING CONVERTER TO VEC3\n    function vec3FromStr(vStr) -- to convert string to vec3\n        local v3 = {};\n        for num in string.gmatch(vStr, \"[-%d%.]+\") do\n            local vN = string.gsub(num, \"%+\", \"\")\n            table.insert(v3, tonumber(vN))\n        end\n        return vec3(table.unpack(v3))\n    end\n\n--SET COORDINATES FROM ATLAS\n    function set_coordinates(body)\n        planet_system = body.system\n        planet_id = body.bodyid\n        planet_radius = body.radius\n        planet_lat = body.coord[\"x\"]\n        planet_lon = body.coord[\"y\"]\n        planet_alt = body.coord[\"z\"]\n\n        local world_coord = \"::pos{\"..planet_system..\",\"..planet_id..\",\"..planet_lat..\",\"..planet_lon..\",\"..planet_alt..\"}\"\n        system.setWaypoint(world_coord)\n    end\n\n--SET COORDINATES FROM WP\n    function set_wp_coordinates(body)\n        system.setWaypoint(\"::pos{0,0,\"..body:gsub(\"[()]\",\"\")..\"}\")\n    end\n\n--WORLD TO VEC3 COORDINATES\n    function coord_converter()\n        for i = 1, #planet_data do\n            if planet_data[i].id == wp_selected_planet then\n                planet_center = planet_data[i].coord\n                planet_radius = planet_data[i].radius\n                planet_system = planet_data[i].system\n            end\n        end\n\n        local wp_pos = {system= planet_system, lat = tonumber(keypad_input_wp_lat), lon = tonumber(keypad_input_wp_lon), alt = tonumber(keypad_input_wp_alt)}\n\n        local deg2rad = math.pi/180\n\n        local lat_rad = wp_pos.lat * deg2rad\n        local lon_rad = wp_pos.lon * deg2rad\n\n        local xproj = math.cos(lat_rad)\n\n        return planet_center + (planet_radius + wp_pos.alt) * vec3(xproj*math.cos(lon_rad),\n               xproj*math.sin(lon_rad),\n               math.sin(lat_rad))\n    end\n\n\n--WP CHECKER\n    function wp_check()\n        if wp1 == \"\" then wp1 = databank.setStringValue(\"wp1\", keypad_input_wpname) databank.setStringValue(\"wp1_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp2 == \"\" then wp2 = databank.setStringValue(\"wp2\", keypad_input_wpname) databank.setStringValue(\"wp2_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp3 == \"\" then wp3 = databank.setStringValue(\"wp3\", keypad_input_wpname) databank.setStringValue(\"wp3_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp4 == \"\" then wp4 = databank.setStringValue(\"wp4\", keypad_input_wpname) databank.setStringValue(\"wp4_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp5 == \"\" then wp5 = databank.setStringValue(\"wp5\", keypad_input_wpname) databank.setStringValue(\"wp5_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp6 == \"\" then wp6 = databank.setStringValue(\"wp6\", keypad_input_wpname) databank.setStringValue(\"wp6_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp7 == \"\" then wp7 = databank.setStringValue(\"wp7\", keypad_input_wpname) databank.setStringValue(\"wp7_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp8 == \"\" then wp8 = databank.setStringValue(\"wp8\", keypad_input_wpname) databank.setStringValue(\"wp8_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp9 == \"\" then wp9 = databank.setStringValue(\"wp9\", keypad_input_wpname) databank.setStringValue(\"wp9_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp10 == \"\" then wp10 = databank.setStringValue(\"wp10\", keypad_input_wpname) databank.setStringValue(\"wp10_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp11 == \"\" then wp11 = databank.setStringValue(\"wp11\", keypad_input_wpname) databank.setStringValue(\"wp11_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp12 == \"\" then wp12 = databank.setStringValue(\"wp12\", keypad_input_wpname) databank.setStringValue(\"wp12_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp13 == \"\" then wp13 = databank.setStringValue(\"wp13\", keypad_input_wpname) databank.setStringValue(\"wp13_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp14 == \"\" then wp14 = databank.setStringValue(\"wp14\", keypad_input_wpname) databank.setStringValue(\"wp14_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp15 == \"\" then wp15 = databank.setStringValue(\"wp15\", keypad_input_wpname) databank.setStringValue(\"wp15_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp16 == \"\" then wp16 = databank.setStringValue(\"wp16\", keypad_input_wpname) databank.setStringValue(\"wp16_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp17 == \"\" then wp17 = databank.setStringValue(\"wp17\", keypad_input_wpname) databank.setStringValue(\"wp17_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp18 == \"\" then wp18 = databank.setStringValue(\"wp18\", keypad_input_wpname) databank.setStringValue(\"wp18_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp19 == \"\" then wp19 = databank.setStringValue(\"wp19\", keypad_input_wpname) databank.setStringValue(\"wp19_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        elseif wp20 == \"\" then wp20 = databank.setStringValue(\"wp20\", keypad_input_wpname) databank.setStringValue(\"wp20_coord\", tostring(from_coordinates))\n            stored = \"STORED\"\n        else\n            stored = \"Mem Full\"\n        end\n    end\n\n--MAIN MENU\n    local screenState = 0\n    tick_1 = \"\"\n    tick_2 = \"\"\n    tick_3 = \"\"\n    tick_4 = \"\"\n    tick_5 = \"\"\n    tick_6 = \"\"\n    tick_7 = \"\"\n    tick_8 = \"\"\n    tick_9 = \"\"\n    tick_10 = \"\"\n\n    function menu() -- menu buttons\n        screen.clear()\n        sgui:createButtonArea(screen, 0, 0.01, 0.3, 0.08, \"Su Time Calculator\", function()\n            time_to_go = \" \"\n            screenState = 1\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.31, 0.01, 0.3, 0.08, \"From\", function()\n            screenState = 2\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.62, 0.01, 0.3, 0.08, \"Destination\", function()\n            screenState = 3\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0, 0.1, 0.145, 0.08, \"ADD WP\", function()\n            if (screenState == 2 and keypad_input_from == \"PPOS\" and keypad_input_wpname ~= \"\") then\n                wp_check()\n                databank_key_stored = databank.getNbKeys()\n                screenState = 2\n                screenStateManager()\n            elseif (screenState == 7 and wp_name_inserted == true and wp_lat_inserted == true and wp_lon_inserted == true and wp_alt_inserted == true and (wp_name_tick == \" > \" or wp_lat_tick == \" > \" or wp_lon_tick == \" > \" or wp_alt_tick == \" > \")) then\n                keypad_input_wpname = keypad_input_wp_name\n                from_coordinates = coord_converter()\n                wp_check()\n                if stored == \"Mem Full\" then\n                    screenState = 7\n                else\n                    screenState = 0\n                end\n                databank_key_stored = databank.getNbKeys()\n                screenStateManager()\n            end\n        end)\n        sgui:createButtonArea(screen, 0.155, 0.1, 0.145, 0.08, \"CLR WP\", function()\n            if (screenState == 2 and keypad_input_from == \"PPOS\" and keypad_input_wpname ~= \"\")then\n                if keypad_input_wpname == \"all\" then\n                    wp1 = databank.setStringValue(\"wp1\", \"\")\n                    wp2 = databank.setStringValue(\"wp2\", \"\")\n                    wp3 = databank.setStringValue(\"wp3\", \"\")\n                    wp4 = databank.setStringValue(\"wp4\", \"\")\n                    wp5 = databank.setStringValue(\"wp5\", \"\")\n                    wp6 = databank.setStringValue(\"wp6\", \"\")\n                    wp7 = databank.setStringValue(\"wp7\", \"\")\n                    wp8 = databank.setStringValue(\"wp8\", \"\")\n                    wp9 = databank.setStringValue(\"wp9\", \"\")\n                    wp10 = databank.setStringValue(\"wp10\", \"\")\n                    wp11 = databank.setStringValue(\"wp11\", \"\")\n                    wp12 = databank.setStringValue(\"wp12\", \"\")\n                    wp13 = databank.setStringValue(\"wp13\", \"\")\n                    wp14 = databank.setStringValue(\"wp14\", \"\")\n                    wp15 = databank.setStringValue(\"wp15\", \"\")\n                    wp16 = databank.setStringValue(\"wp16\", \"\")\n                    wp17 = databank.setStringValue(\"wp17\", \"\")\n                    wp18 = databank.setStringValue(\"wp18\", \"\")\n                    wp19 = databank.setStringValue(\"wp19\", \"\")\n                    wp20 = databank.setStringValue(\"wp20\", \"\")\n                    stored = \"CLEARED\"\n                end\n            databank_key_stored = databank.getNbKeys()\n            screenState = 2\n            screenStateManager()\n            end\n            if screenState == 0 then\n                if tick_1 == \" > \" then wp1 = databank.setStringValue(\"wp1\", \"\")\n                elseif tick_2 == \" > \" then wp2 = databank.setStringValue(\"wp2\", \"\")\n                elseif tick_3 == \" > \" then wp3 = databank.setStringValue(\"wp3\", \"\")\n                elseif tick_4 == \" > \" then wp4 = databank.setStringValue(\"wp4\", \"\")\n                elseif tick_5 == \" > \" then wp5 = databank.setStringValue(\"wp5\", \"\")\n                elseif tick_6 == \" > \" then wp6 = databank.setStringValue(\"wp6\", \"\")\n                elseif tick_7 == \" > \" then wp7 = databank.setStringValue(\"wp7\", \"\")\n                elseif tick_8 == \" > \" then wp8 = databank.setStringValue(\"wp8\", \"\")\n                elseif tick_9 == \" > \" then wp9 = databank.setStringValue(\"wp9\", \"\")\n                elseif tick_10 == \" > \" then wp10 = databank.setStringValue(\"wp10\", \"\")\n                end\n            databank_key_stored = databank.getNbKeys()\n            screenStateManager()\n            end\n            if screenState == 6 then\n                if tick_1 == \" > \" then wp11 = databank.setStringValue(\"wp11\", \"\")\n                elseif tick_2 == \" > \" then wp12 = databank.setStringValue(\"wp12\", \"\")\n                elseif tick_3 == \" > \" then wp13 = databank.setStringValue(\"wp13\", \"\")\n                elseif tick_4 == \" > \" then wp14 = databank.setStringValue(\"wp14\", \"\")\n                elseif tick_5 == \" > \" then wp15 = databank.setStringValue(\"wp15\", \"\")\n                elseif tick_6 == \" > \" then wp16 = databank.setStringValue(\"wp16\", \"\")\n                elseif tick_7 == \" > \" then wp17 = databank.setStringValue(\"wp17\", \"\")\n                elseif tick_8 == \" > \" then wp18 = databank.setStringValue(\"wp18\", \"\")\n                elseif tick_9 == \" > \" then wp19 = databank.setStringValue(\"wp19\", \"\")\n                elseif tick_10 == \" > \" then wp20 = databank.setStringValue(\"wp20\", \"\")\n                end\n            databank_key_stored = databank.getNbKeys()\n            screenStateManager()\n            end\n        end)\n        sgui:createButtonArea(screen, 0, 0.2, 0.145, 0.08, \"SHOW WP\", function()\n            screenState = 0\n            tick_1 = \"\"\n            tick_2 = \"\"\n            tick_3 = \"\"\n            tick_4 = \"\"\n            tick_5 = \"\"\n            tick_6 = \"\"\n            tick_7 = \"\"\n            tick_8 = \"\"\n            tick_9 = \"\"\n            tick_10 = \"\"\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.31, 0.1, 0.3, 0.08, \"Settings\", function()\n            MTOW_tick = \" > \"\n            autobrake_tick = \" \"\n            screenState = 5\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.62, 0.1, 0.3, 0.08, \"Pe Target Alt\", function()\n            target_alt_warning = \"\"\n            screenState = 4\n            screenStateManager()\n        end)\n\n    end\n    menu()\n\n--DATABANK INITIALIZATION\n    function databank_initialization()\n        databank.setStringValue(\"databank_verification\", \"Verified\")\n        databank.setFloatValue(\"navigator_speed\", \"n/a\")\n        databank.setFloatValue(\"navigator_distance\", \"n/a\")\n        databank.setStringValue(\"navigator_target_destination\", \"no Dest.\")\n        databank.setStringValue(\"navigator_coordinates\", \"n/a\")\n        databank.setFloatValue(\"navigator_eta_h\", 0)\n        databank.setFloatValue(\"navigator_eta_m\", 0)\n        databank.setFloatValue(\"navigator_eta_s\", 0)\n        databank.setStringValue(\"navigator_from_coordinates\", \"n/a\")\n        databank.setStringValue(\"navigator_from\", \"no From\")\n        databank.setFloatValue(\"navigator_pe_target_altitude\", factory_PE_target_altitude)\n        databank.setIntValue(\"navigator_from_planet_radius\", 0)\n        databank.setIntValue(\"navigator_target_planet_radius\", 0)\n        databank.setFloatValue(\"navigator_autobrake\", factory_autobrake)\n        databank.setFloatValue(\"navigator_MTOW\", factory_MTOW)\n    end\n\n--DATA STATUS\n    status_FM = [[ ]]\n    status_TO = [[ ]]\n    status_TA = [[ ]]\n    function data_status()\n        if (databank.getStringValue(\"databank_verification\") ~= \"Verified\") then\n            databank_initialization()\n            databank_key_stored = databank.getNbKeys()\n        else\n            databank_key_stored = databank.getNbKeys()\n        end\n\n        local data_status_table = css_html()\n        data_status_table = data_status_table..[[\n            <table width=\"980vw\">\n                <tr height=\"50vh\"><td class=\"yellow\" width=\"250vw\">Keys Stored:</td><td class=\"center\" width=\"120vw\">]].. databank_key_stored ..[[</td><td class=\"yellow\" width=\"250vw\">Stored:</td><td class=\"center\" width=\"120vw\">]].. status_FM ..[[</td><td class=\"center\" width=\"120vw\">]].. status_TO ..[[</td><td class=\"center\" width=\"120vw\">]].. status_TA ..[[</td></tr>\n            </table>]]\n\n        status_table = screen.addContent(1, 70, data_status_table)\n    end\n    data_status()\n\n--KEYPAD ADD DIGITS\n    function insert_keys(new_digit) -- set rules for digits for different screenState\n\n        --TIME CALCULATOR PAGE\n            if screenState == 1 then\n                if keypad_input_su == \"Distance Invalid\" then\n                   keypad_input_su = nil\n                   databank.setFloatValue(\"navigator_distance\", \"n/a\")\n                   su_distance_inserted = false\n                end\n\n                if time_to_go == \"Speed Is Invalid\" then\n                   keypad_input_speed = nil\n                   databank.setFloatValue(\"navigator_speed\", \"0\")\n                   time_to_go = \" \"\n                   databank.setFloatValue(\"navigator_eta_h\", 0)\n                   databank.setFloatValue(\"navigator_eta_m\", 0)\n                   databank.setFloatValue(\"navigator_eta_s\", 0)\n                end\n\n                if (su_distance_inserted == true and speed_inserted == true) then\n                    keypad_input_speed = nil\n                    databank.setFloatValue(\"navigator_speed\", \"0\")\n                    speed_inserted = false\n                    time_to_go = \" \"\n                    databank.setFloatValue(\"navigator_eta_h\", 0)\n                    databank.setFloatValue(\"navigator_eta_m\", 0)\n                    databank.setFloatValue(\"navigator_eta_s\", 0)\n                end\n\n                if su_distance_inserted == false then\n                    keypad_input = keypad_input_su\n                    keypad_input_su = add_digit(new_digit, keypad_input)\n                elseif speed_inserted == false then\n                    keypad_input = keypad_input_speed\n                    keypad_input_speed = add_digit(new_digit, keypad_input)\n                end\n            end\n\n        --FROM PAGE\n            if screenState == 2 then\n                if (FROM_tick == \" > \" and from_inserted == true) then\n                    keypad_input_from = nil\n                    databank.setStringValue(\"navigator_from\", \"no From\")\n                    from_inserted = false\n                    status_TO = [[FM]]\n                    from_coordinates = \"\"\n                    databank.setStringValue(\"navigator_from_coordinates\", \"n/a\")\n                end\n\n                if from_inserted == false then\n                    keypad_input = keypad_input_from\n                    keypad_input_from = add_digit(new_digit, keypad_input)\n                elseif (from_inserted == true and keypad_input_from == \"PPOS\") then\n                    keypad_input = keypad_input_wpname\n                    keypad_input_wpname = add_digit(new_digit, keypad_input)\n                end\n            end\n\n        --DESTINATION PAGE\n            if screenState == 3 then\n                if (destination_coord == \"Not Present In Databank\" or destination_inserted == true) then\n                   keypad_input_dest = nil\n                   databank.setStringValue(\"navigator_target_destination\", \"no Dest.\")\n                   destination_inserted = false\n                   status_TO = [[ ]]\n                   distance_to_go = \" \"\n                   destination_coord = \"\"\n                   databank.setStringValue(\"navigator_coordinates\", \"n/a\")\n                end\n\n                keypad_input = keypad_input_dest\n                keypad_input_dest = add_digit(new_digit, keypad_input)\n            end\n\n        --TARGET PE ALTITUDE PAGE\n            if screenState == 4 then\n                if (target_alt_warning == \"Warning Altitude Too Low\" or target_pe_altitude_inserted == true or keypad_input_pe_target_alt == \"Invalid Input\") then\n                    keypad_input_pe_target_alt = nil\n                    target_pe_altitude_inserted = false\n                    status_TA = [[ ]]\n                    target_alt_warning = \"\"\n                else\n                    keypad_input_pe_target_alt = keypad_input_pe_target_alt\n                end\n\n                keypad_input = keypad_input_pe_target_alt\n                keypad_input_pe_target_alt = add_digit(new_digit, keypad_input)\n            end\n\n        --SETTINGS PAGE\n            if screenState == 5 then\n\n                if (MTOW_inserted == true and MTOW_tick == \" > \") then\n                    keypad_input_MTOW = \"\"\n                    MTOW_inserted = false\n                end\n\n                if (autobrake_stops_at_inserted == true and autobrake_tick == \" > \") then\n                    keypad_input_autobrake = \"\"\n                    autobrake_stops_at_inserted = false\n                end\n\n                if MTOW_inserted == false then\n                    keypad_input = keypad_input_MTOW\n                    keypad_input_MTOW = add_digit(new_digit, keypad_input)\n                elseif autobrake_stops_at_inserted == false then\n                    keypad_input = keypad_input_autobrake\n                    keypad_input_autobrake = add_digit(new_digit, keypad_input)\n                end\n            end\n\n            if screenState == 7 then\n                if wp_name_tick == \" > \" then\n                    keypad_input = keypad_input_wp_name\n                    keypad_input_wp_name = add_digit(new_digit, keypad_input)\n                elseif wp_lat_tick == \" > \" then\n                    keypad_input = keypad_input_wp_lat\n                    keypad_input_wp_lat = add_digit(new_digit, keypad_input)\n                elseif wp_lon_tick == \" > \" then\n                    keypad_input = keypad_input_wp_lon\n                    keypad_input_wp_lon = add_digit(new_digit, keypad_input)\n                elseif wp_alt_tick == \" > \" then\n                    keypad_input = keypad_input_wp_alt\n                    keypad_input_wp_alt = add_digit(new_digit, keypad_input)\n                end\n            end\n    end\n\n    function add_digit(new_digit, keypad_input)  -- to concatenate digits\n        if keypad_input then\n            return tostring(keypad_input) .. tostring(new_digit)\n            else\n            return new_digit\n        end\n    end\n\n--KEYPAD NUMBERS\n    function keypad_numbers()\n\n        sgui:createButtonArea(screen, 0,0.3,0.06,0.08, \"1\", function()\n            local new_digit = 1\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.07,0.3,0.06,0.08, \"2\", function()\n            local new_digit = 2\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.14,0.3,0.06,0.08, \"3\", function()\n            local new_digit = 3\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0,0.4,0.06,0.08, \"4\", function() \n            local new_digit = 4\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.07,0.4,0.06,0.08, \"5\", function() \n            local new_digit = 5\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.14,0.4,0.06,0.08, \"6\", function() \n            local new_digit = 6\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0,0.5,0.06,0.08, \"7\", function() \n            local new_digit = 7\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.07,0.5,0.06,0.08, \"8\", function() \n            local new_digit = 8\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.14,0.5,0.06,0.08, \"9\", function() \n            local new_digit = 9\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.07,0.6,0.06,0.08, \"0\", function() \n            local new_digit = 0\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0,0.6,0.06,0.08, \"CLR\", function()\n            clr_button()\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.14,0.6,0.06,0.08, \"ENT\", function()\n            ent_button()\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.21,0.6,0.03,0.08, \".\", function()\n            local new_digit = \".\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.25,0.3,0.03,0.08, \"↑\", function()\n            if (screenState == 0 or screenState == 6) then\n                if tick_10 == \" > \" then tick_10 = \"\" tick_9 = \" > \"\n                elseif tick_9 == \" > \" then tick_9 = \"\" tick_8 = \" > \"\n                elseif tick_8 == \" > \" then tick_8 = \"\" tick_7 = \" > \"\n                elseif tick_7 == \" > \" then tick_7 = \"\" tick_6 = \" > \"\n                elseif tick_6 == \" > \" then tick_6 = \"\" tick_5 = \" > \"\n                elseif tick_5 == \" > \" then tick_5 = \"\" tick_4 = \" > \"\n                elseif tick_4 == \" > \" then tick_4= \"\" tick_3 = \" > \"\n                elseif tick_3 == \" > \" then tick_3 = \"\" tick_2 = \" > \"\n                elseif tick_2 == \" > \" then tick_2 = \"\" tick_1 = \" > \"\n                end\n                screenStateManager()\n            end\n            if screenState == 7 then\n                if wp_lat_tick == \" > \" then\n                    wp_name_tick = \" > \"\n                    wp_lat_tick = \" \"\n                elseif wp_lon_tick == \" > \" then\n                    wp_lat_tick = \" > \"\n                    wp_lon_tick = \" \"\n                elseif wp_alt_tick == \" > \" then\n                    wp_lon_tick = \" > \"\n                    wp_alt_tick = \" \"\n                end\n                screenStateManager()\n            end\n            if screenState == 8 then\n                if up_sync_tick == \" > \" then\n                    up_sync_tick = \" \"\n                    dwn_sync_tick = \" > \"\n                end\n                screenStateManager()\n            end\n        end)\n        sgui:createButtonArea(screen, 0.21,0.3,0.03,0.08, \"&#x21D1\", function()\n            if screenState == 6 then    --wp2\n                screenState = 0         --wp1\n                tick_1 = \"\"\n                tick_2 = \"\"\n                tick_3 = \"\"\n                tick_4 = \"\"\n                tick_5 = \"\"\n                tick_6 = \"\"\n                tick_7 = \"\"\n                tick_8 = \"\"\n                tick_9 = \"\"\n                tick_10 = \"\"\n                screenStateManager()\n            end\n            if screenState == 7 then    --settings2\n                screenState = 5         --settings1\n                screenStateManager()\n            end\n            if screenState == 8 then    --settings3\n                screenState = 7         --settings2\n                wp_name_tick = \" > \"\n                wp_lat_tick = \" \"\n                wp_lon_tick = \" \"\n                wp_alt_tick = \" \"\n                screenStateManager()\n            end\n        end)\n        sgui:createButtonArea(screen, 0.25,0.4,0.03,0.08, \"↓\", function()\n            if (screenState == 0 or screenState == 6)then\n                if tick_1 == \"\" then tick_1 = \" > \"\n                elseif tick_1 == \" > \" then tick_1 = \" \" tick_2 = \" > \"\n                elseif tick_2 == \" > \" then tick_2 = \"\" tick_3 = \" > \"\n                elseif tick_3 == \" > \" then tick_3 = \"\" tick_4 = \" > \"\n                elseif tick_4 == \" > \" then tick_4 = \"\" tick_5 = \" > \"\n                elseif tick_5 == \" > \" then tick_5 = \"\" tick_6 = \" > \"\n                elseif tick_6 == \" > \" then tick_6 = \"\" tick_7 = \" > \"\n                elseif tick_7 == \" > \" then tick_7 = \"\" tick_8 = \" > \"\n                elseif tick_8 == \" > \" then tick_8 = \"\" tick_9 = \" > \"\n                elseif tick_9 == \" > \" then tick_9 = \"\" tick_10 = \" > \"\n                end\n                screenStateManager()\n            end\n            if screenState == 7 then\n                if wp_name_tick == \" > \" then\n                    wp_name_tick = \" \"\n                    wp_lat_tick = \" > \"\n                elseif wp_lat_tick == \" > \" then\n                    wp_lat_tick = \" \"\n                    wp_lon_tick = \" > \"\n                elseif wp_lon_tick == \" > \" then\n                    wp_lon_tick = \" \"\n                    wp_alt_tick = \" > \"\n                end\n                screenStateManager()\n            end\n            if screenState == 8 then\n                if dwn_sync_tick == \" > \" then\n                    dwn_sync_tick = \" \"\n                    up_sync_tick = \" > \"\n                end\n                screenStateManager()\n            end\n        end)\n        sgui:createButtonArea(screen, 0.21,0.4,0.03,0.08, \"&#x21D3\", function()\n            if screenState == 0 then    --wp1\n                screenState = 6         --wp2\n                tick_1 = \"\"\n                tick_2 = \"\"\n                tick_3 = \"\"\n                tick_4 = \"\"\n                tick_5 = \"\"\n                tick_6 = \"\"\n                tick_7 = \"\"\n                tick_8 = \"\"\n                tick_9 = \"\"\n                tick_10 = \"\"\n                screenStateManager()\n            end\n            if screenState == 7 then    --settings2\n                screenState = 8         --settings3\n                dwn_sync_tick = \" > \"\n                up_sync_tick = \" \"\n                sync_result = \"\"\n                wp_synced = 0\n                index_sync = 1\n                prog_bar = 0\n                screenStateManager()\n            end\n            if screenState == 5 then    --settings1\n                screenState = 7         --settings2\n                wp_name_tick = \" > \"\n                wp_lat_tick = \" \"\n                wp_lon_tick = \" \"\n                wp_alt_tick = \" \"\n                screenStateManager()\n            end\n        end)\n    end\n    keypad_numbers()\n\n--KEYPAD LETTERS\n    function keypad_letters()\n\n        sgui:createButtonArea(screen, 0,0.8,0.06,0.08, \"A\", function()\n            local new_digit = \"a\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.07,0.8,0.06,0.08, \"B\", function()\n            local new_digit = \"b\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.14,0.8,0.06,0.08, \"C\", function()\n            local new_digit = \"c\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.21,0.8,0.06,0.08, \"D\", function()\n            local new_digit = \"d\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.28,0.8,0.06,0.08, \"E\", function()\n            local new_digit = \"e\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.35,0.8,0.06,0.08, \"F\", function()\n            local new_digit = \"f\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.42,0.8,0.06,0.08, \"G\", function()\n            local new_digit = \"g\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.49,0.8,0.06,0.08, \"H\", function()\n            local new_digit = \"h\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.56,0.8,0.06,0.08, \"I\", function()\n            local new_digit = \"i\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.63,0.8,0.06,0.08, \"J\", function()\n            local new_digit = \"j\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.70,0.8,0.06,0.08, \"K\", function()\n            local new_digit = \"k\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.77,0.8,0.06,0.08, \"L\", function()\n            local new_digit = \"l\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.84,0.8,0.06,0.08, \"M\", function()\n            local new_digit = \"m\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.91,0.8,0.06,0.08, \"N/-\", function()\n            if (screenState == 7 and (wp_lat_tick == \" > \" or wp_lon_tick == \" > \" or wp_alt_tick == \" > \")) then\n                local new_digit = \"-0\"\n                insert_keys(new_digit)\n                screenStateManager()\n            else\n                local new_digit = \"n\"\n                insert_keys(new_digit)\n                screenStateManager()\n            end\n        end)\n    -- second line\n        sgui:createButtonArea(screen, 0,0.9,0.06,0.08, \"O\", function()\n            local new_digit = \"o\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.07,0.9,0.06,0.08, \"P\", function()\n            local new_digit = \"p\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.14,0.9,0.06,0.08, \"Q\", function()\n            local new_digit = \"q\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.21,0.9,0.06,0.08, \"R\", function()\n            local new_digit = \"r\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.28,0.9,0.06,0.08, \"S\", function()\n            local new_digit = \"s\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.35,0.9,0.06,0.08, \"T\", function()\n            local new_digit = \"t\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.42,0.9,0.06,0.08, \"U\", function()\n            local new_digit = \"u\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.49,0.9,0.06,0.08, \"V\", function()\n            local new_digit = \"v\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.56,0.9,0.06,0.08, \"W\", function()\n            local new_digit = \"w\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.63,0.9,0.06,0.08, \"X\", function()\n            local new_digit = \"x\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.70,0.9,0.06,0.08, \"Y\", function()\n            local new_digit = \"y\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.77,0.9,0.06,0.08, \"Z\", function()\n            local new_digit = \"z\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.84,0.9,0.04,0.08, \"_\", function()\n            local new_digit = \"_\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n        sgui:createButtonArea(screen, 0.89,0.9,0.08,0.08, \"Moon\", function()\n            local new_digit = \"_moon_\"\n            insert_keys(new_digit)\n            screenStateManager()\n        end)\n    end\n    keypad_letters()\n\n--ENT BUTTON FUNCTION\n    function ent_button()\n        -- ENT Time Calculator\n            if screenState == 1 then\n                if (su_distance_inserted == true and (keypad_input_speed ~= \" \" or keypad_input_speed == \" \" or tonumber(keypad_input_speed) > 0)) then\n                    local su_num = tonumber(keypad_input_su)\n                    local speed_num = tonumber(keypad_input_speed)\n                    if (keypad_input_speed == \" \" or speed_num >= 30000) then\n                        if math.floor((vec3(core.getVelocity()):len())*3.6) == 0 then\n                            keypad_input_speed = \"0\"\n                            databank.setFloatValue(\"navigator_speed\", 0)\n                            speed_num = 0\n                            databank.setFloatValue(\"navigator_eta_h\", 0)\n                            databank.setFloatValue(\"navigator_eta_m\", 0)\n                            databank.setFloatValue(\"navigator_eta_s\", 0)\n                            speed_inserted = false\n                        else\n                            keypad_input_speed = tostring(math.floor((vec3(core.getVelocity()):len())*3.6))\n                            speed_num = math.floor((vec3(core.getVelocity()):len())*3.6)\n                            databank.setFloatValue(\"navigator_speed\", speed_num)\n                            speed_inserted = true\n                        end\n                    else\n                        speed_num = tonumber(keypad_input_speed)\n                        databank.setFloatValue(\"navigator_speed\", speed_num)\n                    end\n                    if speed_num == 0 then\n                        time_to_go = \"Speed Is Invalid\"\n                        databank.setFloatValue(\"navigator_eta_h\", 0)\n                        databank.setFloatValue(\"navigator_eta_m\", 0)\n                        databank.setFloatValue(\"navigator_eta_s\", 0)\n                        speed_inserted = false\n                    else\n                        local time_min = (su_num*200/speed_num*60)\n                        local time_h   = (time_min/60)\n                        local time_m   = (time_h - math.floor(time_h))*60\n                        local time_s   = (time_m - math.floor(time_m))*60\n                        time_to_go = math.floor(time_h) ..\" h \".. math.floor(time_m) ..\" m \".. math.floor(time_s) ..\" s\"\n                        databank.setFloatValue(\"navigator_eta_h\", math.floor(time_h))\n                        databank.setFloatValue(\"navigator_eta_m\", math.floor(time_m))\n                        databank.setFloatValue(\"navigator_eta_s\", math.floor(time_s))\n                        speed_inserted = true\n                    end\n                elseif (su_distance_inserted == false and (keypad_input_su == \" \" or keypad_input_su == \"Distance Invalid\") and keypad_input_speed == \" \") then\n                    keypad_input_su = \"Distance Invalid\"\n                    databank.setFloatValue(\"navigator_distance\", \"n/a\")\n                    screen.resetContent(IDdata_monitor, su_distance_time())\n                elseif (su_distance_inserted == false and keypad_input_su ~= \" \" and keypad_input_speed == \" \") then\n                    databank.setFloatValue(\"navigator_distance\", keypad_input_su)\n                    su_distance_inserted = true\n                    su_tick = \" \"\n                    speed_tick = \" > \"\n                end\n            end\n        -- ENT From\n            if screenState == 2 then\n                if (from_inserted == false and keypad_input_from == \"\") then\n                    local myPos = vec3(core.getConstructWorldPos())\n                    keypad_input_from = \"PPOS\"\n                    databank.setStringValue(\"navigator_from\", \"PPOS\")\n                    databank.setStringValue(\"from\", \"PPOS\")\n                    from_coordinates = tostring(myPos)\n                    databank.setStringValue(\"navigator_from_coordinates\", tostring(myPos))\n                    from_inserted = true\n                    status_FM = [[FM]]\n                    FROM_tick = \" \"\n                    WPADD_tick = \" > \"\n                elseif (from_inserted == false and keypad_input_from ~= \"\") then\n                    from_coordinates_check = false\n                    for i = 1, #planet_data do\n                        if planet_data[i].id == keypad_input_from then\n                            databank.setStringValue(\"navigator_from\", planet_data[i].name)\n                            databank.setIntValue(\"navigator_from_planet_radius\", planet_data[i].radius)\n                            databank.setStringValue(\"from\", keypad_input_from)\n                            from_inserted = true\n                            status_FM = [[FM]]\n                            from_coordinates = vec3(planet_data[i].coord)\n                            databank.setStringValue(\"navigator_from_coordinates\", tostring(from_coordinates))\n                            from_coordinates_check = true\n                        elseif databank.hasKey(keypad_input_from) == 1 then\n                            wp_check = keypad_input_from\n                            if databank.getStringValue(wp_check) ~= \"\" then\n                                keypad_input_from = databank.getStringValue(wp_check)\n                                keypad_input_from_coord = wp_check ..\"_coord\"\n                                databank.setStringValue(\"navigator_from\", keypad_input_from)\n                                databank.setStringValue(\"from\", keypad_input_from)\n                                databank.setIntValue(\"navigator_from_planet_radius\", 1)\n                                from_inserted = true\n                                status_FM = [[FM]]\n                                from_coordinates = vec3FromStr(databank.getStringValue(keypad_input_from_coord))\n                                databank.setStringValue(\"navigator_from_coordinates\", tostring(from_coordinates))\n                                from_coordinates_check = true\n                            end\n                        elseif from_coordinates_check == false then\n                            databank.setStringValue(\"navigator_from\", \"no From\")\n                            from_inserted = false\n                            status_FM = [[ ]]\n                            from_coordinates = \"Not Present In Databank\"\n                            databank.setStringValue(\"navigator_from_coordinates\", \"n/a\")\n                            FROM_tick = \" > \"\n                            WPADD_tick = \" \"\n                        end\n                    end\n                end\n            end\n        -- ENT Destination\n            if screenState == 3 then\n                if (destination_inserted == false and keypad_input_dest ~= \"\") then\n                    destination_check = false\n                    for i = 1, #planet_data do\n                        if planet_data[i].id == keypad_input_dest then\n                            databank.setStringValue(\"navigator_target_destination\", planet_data[i].name)\n                            databank.setStringValue(\"to\", keypad_input_dest)\n                            databank.setIntValue(\"navigator_target_planet_radius\", planet_data[i].radius)\n                            destination_inserted = true\n                            status_TO = [[TO]]\n                            local myPos = vec3(core.getConstructWorldPos())\n                            destination_coord = vec3(planet_data[i].coord)\n                            databank.setStringValue(\"navigator_coordinates\", tostring(destination_coord))\n                            set_coordinates(planet_data[i])\n                            distance_to_go = math.floor(((vec3(planet_data[i].coord) - myPos):len())/1000/200*100)/100\n                            distance_to_go_warp = distance_to_go\n                            databank.setFloatValue(\"navigator_distance\", distance_to_go)\n                            databank.setFloatValue(\"navigator_eta_h\", 0)\n                            databank.setFloatValue(\"navigator_eta_m\", 0)\n                            databank.setFloatValue(\"navigator_eta_s\", 0)\n                            destination_check = true\n                        elseif databank.hasKey(keypad_input_dest) == 1 then\n                            wp_check = keypad_input_dest\n                            if databank.getStringValue(wp_check) ~= \"\" then\n                                keypad_input_dest = databank.getStringValue(wp_check)\n                                keypad_input_dest_coord = wp_check ..\"_coord\"\n                                databank.setStringValue(\"navigator_target_destination\", keypad_input_dest)\n                                databank.setStringValue(\"to\", keypad_input_dest)\n                                databank.setIntValue(\"navigator_target_planet_radius\", 1)\n                                destination_inserted = true\n                                status_TO = [[TO]]\n                                local myPos = vec3(core.getConstructWorldPos())\n                                destination_coord = vec3FromStr(databank.getStringValue(keypad_input_dest_coord))\n                                databank.setStringValue(\"navigator_coordinates\", tostring(destination_coord))\n                                set_wp_coordinates(databank.getStringValue(keypad_input_dest_coord))\n                                distance_to_go = math.floor(((destination_coord - myPos):len())/1000/200*100)/100\n                                distance_to_go_warp = distance_to_go\n                                databank.setFloatValue(\"navigator_distance\", distance_to_go)\n                                databank.setFloatValue(\"navigator_eta_h\", 0)\n                                databank.setFloatValue(\"navigator_eta_m\", 0)\n                                databank.setFloatValue(\"navigator_eta_s\", 0)\n                                destination_check = true\n                            else\n                                databank.setStringValue(\"navigator_target_destination\", \"no Dest.\")\n                                destination_inserted = false\n                                status_TO = [[ ]]\n                                destination_coord = \"Not Present In Databank\"\n                                databank.setStringValue(\"navigator_coordinates\", \"n/a\")\n                            end\n                        elseif (destination_check == false) then\n                            databank.setStringValue(\"navigator_target_destination\", \"no Dest.\")\n                            destination_inserted = false\n                            status_TO = [[ ]]\n                            destination_coord = \"Not Present In Databank\"\n                            databank.setStringValue(\"navigator_coordinates\", \"n/a\")\n                        end\n                    end\n                end\n            end\n        -- ENT Target Pe Altitude\n            if screenState == 4 then\n                if (target_pe_altitude_inserted == false and keypad_input_pe_target_alt ~= \"\") then\n                    if tonumber(keypad_input_pe_target_alt) == nil then\n                        keypad_input_pe_target_alt = \"Invalid Input\"\n                        target_pe_altitude_inserted = true\n                        status_TA = [[TA]]\n                    elseif tonumber(keypad_input_pe_target_alt) < 10000 then\n                        target_alt_warning = \"Warning Altitude Too Low\"\n                        target_pe_altitude_inserted = true\n                        status_TA = [[TA]]\n                    elseif tonumber(keypad_input_pe_target_alt) >= 10000 then\n                        databank.setFloatValue(\"navigator_pe_target_altitude\", tonumber(keypad_input_pe_target_alt))\n                        target_pe_altitude_inserted = true\n                        status_TA = [[TA]]\n                        stored_pe_target_alt = keypad_input_pe_target_alt\n                        databank.setFloatValue(\"PE_altitude\", math.floor(stored_pe_target_alt))\n                    elseif keypad_input_pe_target_alt == \"Invalid Input\" then\n                        keypad_input_pe_target_alt = \"Invalid Input\"\n                        target_pe_altitude_inserted = true\n                        status_TA = [[TA]]\n                    end\n                else\n                    keypad_input_pe_target_alt = \"Invalid Input\"\n                    target_pe_altitude_inserted = true\n                    status_TA = [[TA]]\n                end\n            end\n        -- ENT Settings\n            if screenState == 5 then\n                if (MTOW_inserted == false and MTOW_tick == \" > \") then\n                    if (keypad_input_MTOW == \"\") then\n                        keypad_input_MTOW = factory_MTOW/1000\n                        new_MTOW = keypad_input_MTOW\n                        MTOW_inserted = true\n                        databank.setFloatValue(\"navigator_MTOW\", new_MTOW*1000)\n                        MTOW_tick = \" \"\n                        autobrake_tick = \" > \"\n                    else\n                        new_MTOW = tonumber(keypad_input_MTOW)\n                        MTOW_inserted = true\n                        databank.setFloatValue(\"navigator_MTOW\", new_MTOW*1000)\n                        MTOW_tick = \" \"\n                        autobrake_tick = \" > \"\n                    end\n\n                elseif (MTOW_inserted == true and keypad_input_MTOW ~= \"\" and MTOW_tick == \" > \") then\n                    keypad_input_MTOW = keypad_input_MTOW\n                    MTOW_tick = \" \"\n                    autobrake_tick = \" > \"\n\n                elseif (autobrake_stops_at_inserted == false and autobrake_tick == \" > \") then\n                    if (keypad_input_autobrake == \"\") then\n                        keypad_input_autobrake = factory_autobrake\n                        autobrake_stops_at_inserted = true\n                        databank.setFloatValue(\"navigator_autobrake\", keypad_input_autobrake)\n                        MTOW_tick = \" > \"\n                        autobrake_tick = \" \"\n                    else\n                        keypad_input_autobrake = tonumber(keypad_input_autobrake)\n                        autobrake_stops_at_inserted = true\n                        databank.setFloatValue(\"navigator_autobrake\", keypad_input_autobrake)\n                        MTOW_tick = \" > \"\n                        autobrake_tick = \" \"\n                    end\n\n                elseif (autobrake_stops_at_inserted == true and autobrake_tick == \" > \") then\n                    keypad_input_autobrake = keypad_input_autobrake\n                    MTOW_tick = \" > \"\n                    autobrake_tick = \" \"\n                end\n            elseif screenState == 8 then\n                if (dwn_sync_tick == \" > \" and keys_number > 0 and up_sync_tick == \" \") then\n                    sync_data()\n                elseif (keys_number == 0) then\n                    prog_bar = 0\n                    sync_result = \"No Data To Sync\"\n                end\n                if (up_sync_tick == \" > \") then\n                    emitter.send(\"ShipRqst\")\n                    sync_result = \"Uplink\"\n                end\n            end\n    end\n\n--CLR BUTTON FUNCTION\n    function clr_button()\n        -- CLR Time Calculator\n            if screenState == 1 then\n                if (su_distance_inserted == true and keypad_input_su ~= \" \" and keypad_input_speed ~= \" \") then\n                    keypad_input_speed = nil\n                    databank.setFloatValue(\"navigator_speed\", \"0\")\n                    speed_inserted = false\n                    time_to_go = \" \"\n                    databank.setFloatValue(\"navigator_eta_h\", 0)\n                    databank.setFloatValue(\"navigator_eta_m\", 0)\n                    databank.setFloatValue(\"navigator_eta_s\", 0)\n                elseif ( su_distance_inserted == true and keypad_input_su ~= \" \" and keypad_input_speed == \" \") then\n                    keypad_input_su = nil\n                    databank.setStringValue(\"navigator_distance\", \"n/a\")\n                    su_distance_inserted = false\n                    speed_inserted = false\n                    databank.setStringValue(\"navigator_speed\", \"0\")\n                    databank.setFloatValue(\"navigator_eta_h\", 0)\n                    databank.setFloatValue(\"navigator_eta_m\", 0)\n                    databank.setFloatValue(\"navigator_eta_s\", 0)\n                elseif ( su_distance_inserted == false and keypad_input_su ~= \" \" and keypad_input_speed == \" \") then\n                    keypad_input_su = nil\n                    databank.setStringValue(\"navigator_distance\", \"n/a\")\n                    databank.setFloatValue(\"navigator_eta_h\", 0)\n                    databank.setFloatValue(\"navigator_eta_m\", 0)\n                    databank.setFloatValue(\"navigator_eta_s\", 0)\n                end\n            end\n        -- CLR From\n            if screenState == 2 then\n                if (keypad_input_from ~= \"\" or WPADD_tick == \" > \")then\n                    keypad_input_from = nil\n                    databank.setStringValue(\"navigator_from\", \"no From\")\n                    from_coordinates = \"\"\n                    databank.setStringValue(\"navigator_from_coordinates\", \"n/a\")\n                    from_inserted = false\n                    status_FM = [[ ]]\n                    databank.setIntValue(\"navigator_from_planet_radius\", 0)\n                    wpname_inserted = false\n                    FROM_tick = \" > \"\n                    WPADD_tick = \" \"\n                    stored = \"\"\n                end\n            end\n        -- CLR Distance To Coordinates\n            if screenState == 3 then\n                if (keypad_input_dest ~= \"\") then\n                    keypad_input_dest = nil\n                    databank.setStringValue(\"navigator_target_destination\", \"no Dest.\")\n                    destination_inserted = false\n                    status_TO = [[ ]]\n                    destination_coord = nil\n                    databank.setStringValue(\"navigator_coordinates\", \"n/a\")\n                    distance_to_go = \" \"\n                    databank.setIntValue(\"navigator_target_planet_radius\", 0)\n                end\n            end\n        -- CLR Target Pe Altitude\n            if screenState == 4 then\n                if (keypad_input_pe_target_alt ~= \"\") then\n                    keypad_input_pe_target_alt = nil\n                    target_pe_altitude_inserted = false\n                    status_TA = [[ ]]\n                    target_alt_warning = \"\"\n                end\n            end\n        -- CLR Settings\n            if screenState == 5 then\n                if ((MTOW_inserted == true or keypad_input_MTOW ~= \"\") and MTOW_tick == \" > \") then\n                    keypad_input_MTOW = \"\"\n                    new_MTOW = factory_MTOW/1000\n                    MTOW_inserted = false\n                    databank.setFloatValue(\"navigator_MTOW\", factory_MTOW)\n                    MTOW_tick = \" > \"\n                    autobrake_tick = \" \"\n                elseif ((autobrake_stops_at_inserted == true or keypad_input_autobrake ~= \"\") and autobrake_tick == \" > \") then\n                    keypad_input_autobrake = \"\"\n                    autobrake_stops_at_inserted = false\n                    databank.setFloatValue(\"navigator_autobrake\", factory_autobrake)\n                    MTOW_tick = \" \"\n                    autobrake_tick = \" > \"\n                end\n            elseif screenState == 7 then\n                if wp_name_tick == \" > \" then\n                    keypad_input_wp_name = \"\"\n                elseif wp_lat_tick == \" > \" then\n                    keypad_input_wp_lat = \"\"\n                elseif wp_lon_tick == \" > \" then\n                    keypad_input_wp_lon = \"\"\n                elseif wp_alt_tick == \" > \" then\n                    keypad_input_wp_alt = \"\"\n                end\n            end\n    end\n\n--STORED WAYPOINTS 1        (screenState = 0)\n    function stored_waypoints_1()\n\n        if databank.getStringValue(\"wp1\") ~= \"\" then wp1 = databank.getStringValue(\"wp1\") else wp1 = \"\" end\n        if databank.getStringValue(\"wp2\") ~= \"\" then wp2 = databank.getStringValue(\"wp2\") else wp2 = \"\" end\n        if databank.getStringValue(\"wp3\") ~= \"\" then wp3 = databank.getStringValue(\"wp3\") else wp3 = \"\" end\n        if databank.getStringValue(\"wp4\") ~= \"\" then wp4 = databank.getStringValue(\"wp4\") else wp4 = \"\" end\n        if databank.getStringValue(\"wp5\") ~= \"\" then wp5 = databank.getStringValue(\"wp5\") else wp5 = \"\" end\n        if databank.getStringValue(\"wp6\") ~= \"\" then wp6 = databank.getStringValue(\"wp6\") else wp6 = \"\" end\n        if databank.getStringValue(\"wp7\") ~= \"\" then wp7 = databank.getStringValue(\"wp7\") else wp7 = \"\" end\n        if databank.getStringValue(\"wp8\") ~= \"\" then wp8 = databank.getStringValue(\"wp8\") else wp8 = \"\" end\n        if databank.getStringValue(\"wp9\") ~= \"\" then wp9 = databank.getStringValue(\"wp9\") else wp9 = \"\" end\n        if databank.getStringValue(\"wp10\") ~= \"\" then wp10 = databank.getStringValue(\"wp10\") else wp10 = \"\" end\n\n        local stored_waypoints_1_table = css_html()\n        stored_waypoints_1_table = stored_waypoints_1_table..[[\n            <table width=\"630vw\">\n                <tr height=\"50vh\"><td colspan=\"4\" class=\"center yellow\">STORED WP &#x21D1 Page 1/2 &#x21D3</td></tr>\n                <tr height=\"50vh\"><td class=\"yellow\" width=\"45vw\">1</td><td width=\"270vw\" class=\"white\"><span class=\"red\">]]..tick_1..[[</span>]].. wp1 ..[[</td><td class=\"yellow\" width=\"45vw\">6</td><td width=\"270vw\" class=\"white\"><span class=\"red\">]]..tick_6..[[</span>]].. wp6 ..[[</td></tr>\n                <tr height=\"50vh\"><td class=\"yellow\">2</td><td class=\"white\"><span class=\"red\">]]..tick_2..[[</span>]].. wp2 ..[[</td><td class=\"yellow\">7</td><td class=\"white\"><span class=\"red\">]]..tick_7..[[</span>]].. wp7 ..[[</td></tr>\n                <tr height=\"50vh\"><td class=\"yellow\">3</td><td class=\"white\"><span class=\"red\">]]..tick_3..[[</span>]].. wp3 ..[[</td><td class=\"yellow\">8</td><td class=\"white\"><span class=\"red\">]]..tick_8..[[</span>]].. wp8 ..[[</td></tr>\n                <tr height=\"50vh\"><td class=\"yellow\">4</td><td class=\"white\"><span class=\"red\">]]..tick_4..[[</span>]].. wp4 ..[[</td><td class=\"yellow\">9</td><td class=\"white\"><span class=\"red\">]]..tick_9..[[</span>]].. wp9 ..[[</td></tr>\n                <tr height=\"50vh\"><td class=\"yellow\">5</td><td class=\"white\"><span class=\"red\">]]..tick_5..[[</span>]].. wp5 ..[[</td><td class=\"yellow\">10</td><td class=\"white\"><span class=\"red\">]]..tick_10..[[</span>]].. wp10 ..[[</td></tr>\n            </table>]]\n        IDdata_monitor = screen.addContent(35, 20, stored_waypoints_1_table)\n    end\n\n--STORED WAYPOINTS 2        (screenState = 6)\n    function stored_waypoints_2()\n\n        if databank.getStringValue(\"wp11\") ~= \"\" then wp11 = databank.getStringValue(\"wp11\") else wp11 = \"\" end\n        if databank.getStringValue(\"wp12\") ~= \"\" then wp12 = databank.getStringValue(\"wp12\") else wp12 = \"\" end\n        if databank.getStringValue(\"wp13\") ~= \"\" then wp13 = databank.getStringValue(\"wp13\") else wp13 = \"\" end\n        if databank.getStringValue(\"wp14\") ~= \"\" then wp14 = databank.getStringValue(\"wp14\") else wp14 = \"\" end\n        if databank.getStringValue(\"wp15\") ~= \"\" then wp15 = databank.getStringValue(\"wp15\") else wp15 = \"\" end\n        if databank.getStringValue(\"wp16\") ~= \"\" then wp16 = databank.getStringValue(\"wp16\") else wp16 = \"\" end\n        if databank.getStringValue(\"wp17\") ~= \"\" then wp17 = databank.getStringValue(\"wp17\") else wp17 = \"\" end\n        if databank.getStringValue(\"wp18\") ~= \"\" then wp18 = databank.getStringValue(\"wp18\") else wp18 = \"\" end\n        if databank.getStringValue(\"wp19\") ~= \"\" then wp19 = databank.getStringValue(\"wp19\") else wp19 = \"\" end\n        if databank.getStringValue(\"wp20\") ~= \"\" then wp20 = databank.getStringValue(\"wp20\") else wp20 = \"\" end\n\n        local stored_waypoints_2_table = css_html()\n        stored_waypoints_2_table = stored_waypoints_2_table..[[\n            <table width=\"630vw\">\n                <tr height=\"50vh\"><td class=\"center yellow\" colspan=\"4\">STORED WP &#x21D1 Page 2/2 &#x21D3</td></tr>\n                <tr height=\"50vh\"><td class=\"yellow\" width=\"45vw\">11</td><td width=\"270vw\"><span class=\"red\">]]..tick_1..[[</span>]].. wp11 ..[[</td><td style=\" color: yellow\" width=\"45vw\">16</td><td width=\"270vw\"><span class=\"red\">]]..tick_6..[[</span>]].. wp16 ..[[</td></tr>\n                <tr height=\"50vh\"><td class=\"yellow\">12</td><td><span class=\"red\">]]..tick_2..[[</span>]].. wp12 ..[[</td><td class=\"yellow\">17</td><td><span class=\"red\">]]..tick_7..[[</span>]].. wp17 ..[[</td></tr>\n                <tr height=\"50vh\"><td class=\"yellow\">13</td><td><span class=\"red\">]]..tick_3..[[</span>]].. wp13 ..[[</td><td class=\"yellow\">18</td><td><span class=\"red\">]]..tick_8..[[</span>]].. wp18 ..[[</td></tr>\n                <tr height=\"50vh\"><td class=\"yellow\">14</td><td><span class=\"red\">]]..tick_4..[[</span>]].. wp14 ..[[</td><td class=\"yellow\">19</td><td><span class=\"red\">]]..tick_9..[[</span>]].. wp19 ..[[</td></tr>\n                <tr height=\"50vh\"><td class=\"yellow\">15</td><td><span class=\"red\">]]..tick_5..[[</span>]].. wp15 ..[[</td><td class=\"yellow\">20</td><td><span class=\"red\">]]..tick_10..[[</span>]].. wp20 ..[[</td></tr>\n            </table>]]\n        IDdata_monitor = screen.addContent(35, 20, stored_waypoints_2_table)\n    end\n\n--SU DISTANCE TIME PAGE     (screenState = 1)\n    function su_distance_time()\n\n        if su_distance_inserted == nil then\n            su_distance_inserted = false\n        end\n\n        if speed_inserted == nil then\n            speed_inserted = false\n        end\n\n        if distance_to_go ~= nil then\n            if distance_to_go ~= \" \" then\n            keypad_input_su = distance_to_go\n            databank.setFloatValue(\"navigator_distance\", keypad_input_su)\n            su_distance_inserted = true\n            su_tick = \" \"\n            speed_tick = \" > \"\n            end\n        end\n\n        if keypad_input_su == nil then\n            keypad_input_su = \" \"\n            su_tick = \" > \"\n            speed_tick = \" \"\n        end\n\n        if keypad_input_speed == nil then \n            keypad_input_speed = \" \"\n        end\n\n        if time_to_go == nil then \n            time_to_go = \" \"\n        end\n\n        if (keypad_input_su == \" \" or keypad_input_su == \"Distance Invalid\") then\n            warp_distance = 0\n        else\n            warp_distance = keypad_input_su\n        end\n\n        local su_distance_time_table = css_html()\n        su_distance_time_table = su_distance_time_table..[[\n            <table width=\"630vw\">\n                <tr height=\"50vh\"><td width=\"30vw\"></td><td class=\"yellow\" colspan=\"2\">Insert The Distance</td></tr>\n                <tr height=\"50vh\"><td>]].. su_tick ..[[</td><td  colspan=\"2\">]].. keypad_input_su ..[[&nbsp<span class=\"cyan\">Su</span></td></tr>\n                <tr height=\"50vh\"><td></td><td class=\"yellow\" colspan=\"2\">Insert Cruising Speed:</td></tr>\n                <tr height=\"50vh\"><td>]].. speed_tick ..[[</td><td colspan=\"2\">]].. keypad_input_speed ..[[&nbsp<span class=\"cyan\">Km/h</span></td></tr>\n                <tr height=\"50vh\"><td></td><td class=\"yellow\">ETA After:</td><td class=\"yellow\">Warp Cells:</td></tr>\n                <tr height=\"50vh\"><td></td><td>]].. time_to_go ..[[</td><td>]].. math.floor((core.getConstructMass()/1000) * warp_distance * 0.00025) ..[[<span class=\"yellow\">&nbsp Max:&nbsp</span>]].. math.floor((new_MTOW) * warp_distance * 0.00025) ..[[</td></tr>\n            </table>]]\n        IDdata_monitor = screen.addContent(35, 20, su_distance_time_table)\n    end\n\n--FROM PAGE                 (screenState = 2)\n    function from()\n\n        if (databank.getStringValue(\"navigator_from\") ~= \"no From\" and databank.getStringValue(\"navigator_from\") ~= \"PPOS\") then\n            keypad_input_from = databank.getStringValue(\"from\")\n        end\n\n        if from_inserted == nil then\n            from_inserted = false\n            status_FM = [[ ]]\n            FROM_tick = \" > \"\n            keypad_input_wpname = \"\"\n            wpname_inserted = false\n            WPADD_tick = \" \"\n            stored = \"\"\n        end\n\n        if keypad_input_from == nil then\n            keypad_input_from = \"\"\n            from_coordinates = \"\"\n            from_inserted = false\n            status_FM = [[ ]]\n            FROM_tick = \" > \"\n            keypad_input_wpname = \"\"\n            wpname_inserted = false\n            WPADD_tick = \" \"\n            stored = \"\"\n        end\n\n        local load_from_table = css_html()\n        load_from_table = load_from_table..[[\n            <table width=\"630vw\">\n                <tr height=\"50vh\"><td width=\"30vw\"></td><td class=\"yellow\" colspan=\"2\">Insert Departure or ENT</td></tr>\n                <tr height=\"50vh\"><td>]].. FROM_tick ..[[</td><td colspan=\"2\">]].. keypad_input_from ..[[</td></tr>\n                <tr height=\"50vh\"><td> </td><td class=\"yellow\" colspan=\"2\">Coordinates:</td></tr>\n                <tr height=\"50vh\"><td colspan=\"3\" style=\" font-size: 30px\">]].. tostring(from_coordinates) ..[[</td></tr>\n                <tr height=\"50vh\"><td width=\"30vw\"></td><td class=\"yellow\" colspan=\"2\">WP Store/Clear</td></tr>\n                <tr height=\"50vh\"><td>]].. WPADD_tick ..[[</td><td width=\"285vw\">]].. keypad_input_wpname ..[[</td><td class=\"center\">]].. stored ..[[</td></tr>\n            </table>]]\n        IDdata_monitor = screen.addContent(35, 20, load_from_table)\n        screen.resetContent(status_table, data_status())\n    end\n\n--DESTINATION PAGE          (screenState = 3)\n    function distance_to_wp()\n\n        if (databank.getStringValue(\"navigator_target_destination\") ~= \"no Dest.\") then\n            keypad_input_dest = databank.getStringValue(\"to\")\n            distance_to_go = databank.getFloatValue(\"navigator_distance\")\n            distance_to_go_warp = databank.getFloatValue(\"navigator_distance\")\n        end\n\n        if destination_inserted == nil then\n            destination_inserted = false\n            status_TO = [[ ]]\n        end\n\n        if keypad_input_dest == nil then\n            keypad_input_dest = \"\"\n            destination_coord = \" \"\n            distance_to_go = \" \"\n            distance_to_go_warp = 0\n        else\n            keypad_input_dest = keypad_input_dest\n        end\n\n        local distance_to_wp_table = css_html()\n        distance_to_wp_table = distance_to_wp_table..[[\n            <table width=\"630vw\">\n                <tr height=\"50vh\"><td width=\"30vw\"></td><td class=\"yellow\" colspan=\"2\">Insert Destination</td></tr>\n                <tr height=\"50vh\"><td> > </td><td colspan=\"2\">]].. keypad_input_dest ..[[</td></tr>\n                <tr height=\"50vh\"><td></td><td class=\"yellow\">Distance:</td><td class=\"yellow\">Warp Cells:</td></tr>\n                <tr height=\"50vh\"><td></td><td>]] .. distance_to_go .. [[&nbsp<span class=\"cyan\">Su</span></td><td>]].. math.floor((core.getConstructMass()/1000) * distance_to_go_warp * 0.00025) ..[[<span class=\"yellow\">&nbsp Max:&nbsp</span>]].. math.floor((new_MTOW) * distance_to_go_warp * 0.00025) ..[[</td></tr>\n                <tr height=\"50vh\"><td></td><td class=\"yellow\" colspan=\"2\">Coordinates:</td></tr>\n                <tr height=\"50vh\"><td colspan=\"3\" class=\"px30\">]].. tostring(destination_coord) ..[[</td></tr>\n            </table>]]\n        IDdata_monitor = screen.addContent(35, 20, distance_to_wp_table)\n        screen.resetContent(status_table, data_status())\n    end\n\n--TARGET PE ALTITUDE PAGE   (screenState = 4)\n    function target_pe_altitude()\n\n        if target_pe_altitude_inserted == nil then\n            target_pe_altitude_inserted = false\n            status_TA = [[ ]]\n        end\n\n        if (databank.getFloatValue(\"PE_altitude\") ~= 0) then\n            stored_pe_target_alt = math.floor(databank.getFloatValue(\"PE_altitude\"))\n        else\n            stored_pe_target_alt = factory_PE_target_altitude\n        end\n\n        if keypad_input_pe_target_alt == nil then\n            keypad_input_pe_target_alt = \"\"\n            target_pe_altitude_inserted = false\n            status_TA = [[ ]]\n        else\n            keypad_input_pe_target_alt = keypad_input_pe_target_alt\n        end\n\n        local load_target_pe_altitude_table = css_html()\n        load_target_pe_altitude_table = load_target_pe_altitude_table..[[\n            <table width=\"630vw\">\n                <tr height=\"50vh\"><td class=\"yellow\">Insert PE Target Altitude</td></tr>\n                <tr height=\"50vh\"><td>]].. keypad_input_pe_target_alt ..[[&nbsp<span class=\"cyan\">mt</span></td></tr>\n                <tr height=\"50vh\"><td>]].. target_alt_warning ..[[</td></tr>\n                <tr height=\"50vh\"><td class=\"yellow\">Stored Altitude</td></tr>\n                <tr height=\"50vh\"><td>]].. stored_pe_target_alt ..[[&nbsp<span class=\"cyan\">mt</span></td></tr>\n            </table>]]\n        IDdata_monitor = screen.addContent(35, 20, load_target_pe_altitude_table)\n        screen.resetContent(status_table, data_status())\n    end\n\n--SETTINGS PAGE 1           (screenState = 5)\n    function settings1()\n\n        if keypad_input_MTOW == nil then\n            keypad_input_MTOW = factory_MTOW/1000\n            new_MTOW = factory_MTOW/1000\n            MTOW_inserted = true\n            MTOW_tick = \" > \"\n            autobrake_tick = \" \"\n        end\n\n        if keypad_input_autobrake == nil then\n            keypad_input_autobrake = factory_autobrake\n            autobrake_stops_at_inserted = true\n        end\n\n        local settings_table_1 = css_html()\n        settings_table_1 = settings_table_1..[[\n            <table width=\"630vw\">\n                <tr height=\"50vh\"><td width=\"30vw\"></td><td width=\"285vw\" class=\"yellow\">MTOW</td><td class=\"yellow center\" colspan=\"2\">&#x21D1 Page 1/3 &#x21D3</td></tr>\n                <tr height=\"50vh\"><td>]].. MTOW_tick ..[[</td><td>]].. keypad_input_MTOW ..[[&nbsp<span class=\"cyan\">t</span></td><td width=\"30vw\"></td><td></td></tr>\n                <tr height=\"50vh\"><td> </td><td class=\"yellow\">Autobrake</td></td><td> </td><td class=\"yellow\">WP Coord</td></tr>\n                <tr height=\"50vh\"><td>]].. autobrake_tick ..[[</td><td>]].. keypad_input_autobrake ..[[&nbsp<span class=\"cyan\">Su</span></td><td></td><td></td></tr>\n                <tr height=\"50vh\"><td></td><td></td><td></td><td></td></tr>\n                <tr height=\"50vh\"><td></td><td></td><td></td><td></td></tr>\n            </table>]]\n        IDdata_monitor = screen.addContent(35, 20, settings_table_1)\n    end\n\n--SETTINGS PAGE 2           (screenState = 7)\n    function settings2()\n        stored = \"\"\n\n        if databank.getStringValue(\"to\") ~= nil then\n            for i = 1, #planet_data do\n                if planet_data[i].id == keypad_input_dest then\n                    wp_selected_planet = databank.getStringValue(\"to\")\n                end\n            end\n        else\n            wp_selected_planet = \"\"\n        end\n\n        if (wp_selected_planet == nil or wp_selected_planet == \"\" or wp_selected_planet == \"Insert Destination\") then\n            wp_selected_planet = \"Insert Destination\"\n            wp_name_tick = \" \"\n            wp_lat_tick = \" \"\n            wp_lon_tick = \" \"\n            wp_alt_tick = \" \"\n            stored = \"\"\n        end\n\n        if (keypad_input_wp_name == nil or keypad_input_wp_name == \"\") then\n            keypad_input_wp_name = \"\"\n            wp_name_inserted = false\n        else\n            wp_name_inserted = true\n        end\n\n        if (tonumber(keypad_input_wp_lat) == nil or keypad_input_wp_lat == \"\") then\n            keypad_input_wp_lat = \"\"\n            wp_lat_inserted = false\n        else\n            wp_lat_inserted = true\n        end\n\n        if (tonumber(keypad_input_wp_lon) == nil or keypad_input_wp_lon == \"\") then\n            keypad_input_wp_lon = \"\"\n            wp_lon_inserted = false\n        else\n            wp_lon_inserted = true\n        end\n\n        if (tonumber(keypad_input_wp_alt) == nil or keypad_input_wp_alt == \"\") then\n            keypad_input_wp_alt = \"\"\n            wp_alt_inserted = false\n        else\n            wp_alt_inserted = true\n        end\n\n        if (wp_name_inserted == true and wp_lat_inserted == true and wp_lon_inserted == true and wp_alt_inserted == true) then\n            wp_coordinated_stored = tostring(coord_converter())\n        else\n            wp_coordinated_stored = \"\"\n        end\n\n        local settings_table_2 = css_html()\n        settings_table_2 = settings_table_2..[[\n            <table width=\"630vw\">\n                <tr height=\"50vh\"><td class=\"cyan center\" colspan=\"2\">]].. wp_selected_planet ..[[</td><td class=\"yellow center\" colspan=\"2\">&#x21D1 Page 2/3 &#x21D3</td></tr>\n                <tr height=\"50vh\"><td width=\"30vw\"></td><td width=\"285vw\" class=\"yellow\">WP Name</td><td width=\"30vw\"></td><td width=\"285vw\" class=\"yellow\">WP Coord</td></tr>\n                <tr height=\"50vh\"><td>]].. wp_name_tick ..[[</td><td>]].. keypad_input_wp_name ..[[</td><td>]].. wp_lat_tick ..[[</td><td>]].. keypad_input_wp_lat ..[[&nbsp<span class=\"cyan\">Lat</span></td></tr>\n                <tr height=\"50vh\"><td></td><td></td><td>]].. wp_lon_tick ..[[</td><td>]].. keypad_input_wp_lon ..[[&nbsp<span class=\"cyan\">Lon</span></td></tr>\n                <tr height=\"50vh\"><td></td><td>]].. stored ..[[</td><td>]].. wp_alt_tick ..[[</td><td>]].. keypad_input_wp_alt ..[[&nbsp<span class=\"cyan\">Alt</span></td></tr>\n                <tr height=\"50vh\"><td colspan=\"4\" class=\"px30\">]].. wp_coordinated_stored ..[[</td></tr>\n            </table>]]\n        IDdata_monitor = screen.addContent(35, 20, settings_table_2)\n    end\n\n--SETTINGS PAGE 3           (screenState = 8)\n    function settings3()\n        local total_key_number = databank.getNbKeys()\n\n        if total_key_number > 0 then\n            local counter = 0\n            for i = 1, total_key_number do\n                local wp_name = \"wp\"..i\n                local wp_name = databank.getStringValue(wp_name)\n\n                if (tostring(wp_name) ~= nil and tostring(wp_name) ~= \"\") then\n                    counter = counter + 1\n                end\n                keys_number = counter\n            end\n        else\n            keys_number = 0\n        end\n        if (sync_result == nil or sync_result == \"\") then\n            sync_result = \"\"\n        end\n\n        local settings_table_3 = css_html()\n        settings_table_3 = settings_table_3..[[\n            <table width=\"630vw\">\n                <tr height=\"50vh\"><td colspan=\"2\" class=\"yellow center\">WP Sync</td><td class=\"yellow center\" colspan=\"2\">&#x21D1 Page 3/3 &#x21D3</td></tr>\n                <tr height=\"50vh\"><td colspan=\"2\" class=\"center yellow\">WP Stored</td><td colspan=\"2\" class=\"center\">]]..keys_number..[[</td></tr>\n                <tr height=\"50vh\"><td width=\"30vw\" class=\"center red\">]]..dwn_sync_tick..[[</td><td width=\"285vw\" class=\"center cyan\"> << Downlink >> </td><td width=\"30vw\" class=\"center red\">]]..up_sync_tick..[[</td><td width=\"285vw\" class=\"center cyan\"> >> Uplink << </td></tr>\n                <tr height=\"50vh\"><td colspan=\"4\">\n                    <svg width=\"]]..prog_bar..[[\" height=\"10\">\n                        <rect x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" style=\" fill: yellow\"/>\n                    </svg>\n                </td></tr>\n                <tr height=\"50vh\"><td colspan=\"4\" class=\"center\">]]..sync_result..[[</td></tr>\n            </table>]]\n        IDdata_monitor = screen.addContent(35, 20, settings_table_3)\n    end\n\n--SCREEN STATE MANAGER\n    function screenStateManager() -- used to refresh the screen according the screenState\n\n        if screenState == 0 then\n            screen.resetContent(IDdata_monitor, stored_waypoints_1())\n        elseif screenState == 1 then\n            screen.resetContent(IDdata_monitor, su_distance_time())\n        elseif screenState == 2 then\n            screen.resetContent(IDdata_monitor, from())\n        elseif screenState == 3 then\n            screen.resetContent(IDdata_monitor, distance_to_wp())\n        elseif screenState == 4 then\n            screen.resetContent(IDdata_monitor, target_pe_altitude())\n        elseif screenState == 5 then\n            screen.resetContent(IDdata_monitor, settings1())\n        elseif screenState == 6 then\n            screen.resetContent(IDdata_monitor, stored_waypoints_2())\n        elseif screenState == 7 then\n            screen.resetContent(IDdata_monitor, settings2())\n        elseif screenState == 8 then\n            screen.resetContent(IDdata_monitor, settings3())\n        end\n\n    end\n    screenStateManager()\n\n--SENDING DATA\n    function sync_data()\n        --CHECKING KEYS NUMBER\n        local total_key_number = databank.getNbKeys()\n        if total_key_number > 0 then\n            local counter = 0\n\n            index_sync = index_sync\n\n            for i = index_sync, total_key_number do\n                local wp_name = 'wp'..i\n                local wp_name = databank.getStringValue(wp_name)\n\n                if (tostring(wp_name) ~= nil and tostring(wp_name) ~= \"\") then\n                    counter = counter + 1\n                    local wp_coord = 'wp'..i..'_coord'\n                    local wp_coord = databank.getStringValue(wp_coord)\n                    system.print(\"TRANSMITTING \"..i..\" : \"..wp_name..\", \"..wp_coord)\n\n                    waypoint = {\n                    wp_n = wp_name,\n                    wp_c = wp_coord\n                    }\n                    json_string = json.encode(waypoint, { indent = false })\n                    if counter <= 3 then\n                        wp_synced = wp_synced + 1\n                        emitter.send(\"ShipData\", json_string:gsub(\"\\\"\",\"@@@\"))\n                    else\n                        break\n                    end\n                end\n                sync_result = \"Synced \"..wp_synced..\" WP\"\n                prog_bar = (wp_synced * 624)/keys_number\n                if index_sync <= total_key_number then\n                    delay_sync = 2\n                    index_sync = index_sync + 1\n                    unit.setTimer(\"delay\", 1)\n                end\n            end\n            screenStateManager()\n        end\n    end\n\n--RECEIVING DATA\n    msg_counter = 0\n    function receiving_data()\n\n        keypad_input_wpname = rcv_msg.wp_n\n        from_coordinates = rcv_msg.wp_c\n        wp_check()\n        screenStateManager()\n\n    end\n\n--ATLAS\n    function planet_data()\n\n        planet_data = {\n           {id = \"madis\",\n            name = \"Madis\",\n            radius = 44300,\n            coord = {x=17465536.000,y=22665536.000,z=-34464.000},\n            system = 0,\n            bodyid = 1\n            },\n            {id = \"alioth\",\n            name = \"Alioth\",\n            radius = 126068,\n            coord = {x=-8.000,y=-8.000,z=-126303.000},\n            system = 0,\n            bodyid = 2\n            },\n            {id = \"thades\",\n            name = \"Thades\",\n            radius = 49000,\n            coord = {x=29165536.000,y=10865536.000,z=65536.000},\n            system = 0,\n            bodyid = 3\n            },\n            {id = \"talemai\",\n            name = \"Talemai\",\n            radius = 57450,\n            coord = {x=-13234464.000,y=55765536.000,z=465536.000},\n            system = 0,\n            bodyid = 4\n            },\n            {id = \"feli\",\n            name = \"Feli\",\n            radius = 60000,\n            coord = {x=-43534464.000,y=22565536.000,z=-48934464.000},\n            system = 0,\n            bodyid = 5\n            },\n            {id = \"sicari\",\n            name = \"Sicari\",\n            radius = 51100,\n            coord = {x=52765536.000,y=27165538.000,z=52065535.000},\n            system = 0,\n            bodyid = 6\n            },\n            {id = \"sinnen\",\n            name = \"Sinnen\",\n            radius = 54950,\n            coord = {x=58665538.000,y=29665535.000,z=58165535.000},\n            system = 0,\n            bodyid = 7\n            },\n            {id = \"teoma\",\n            name = \"Teoma\",\n            radius = 62000,\n            coord = {x=80865538.000,y=54665536.000,z=-934463.940},\n            system = 0,\n            bodyid = 8\n            },\n            {id = \"jago\",\n            name = \"Jago\",\n            radius = 61590,\n            coord = {x=-94134462.000,y=12765534.000,z=-3634464.000},\n            system = 0,\n            bodyid = 9\n            },\n            {id = \"madis_moon_1\",\n            name = \"Madis Moon 1\",\n            radius = 10000,\n            coord = {x=17448118.224,y=22966846.286,z=143078.820},\n            system = 0,\n            bodyid = 10\n            },\n            {id = \"madis_moon_2\",\n            name = \"Madis Moon 2\",\n            radius = 11000,\n            coord = {x=17194626.000,y=22243633.880,z=-214962.810},\n            system = 0,\n            bodyid = 11\n            },\n            {id = \"madis_moon_3\",\n            name = \"Madis Moon 3\",\n            radius = 15005,\n            coord = {x=17520614.000,y=22184730.000,z=-309989.990},\n            system = 0,\n            bodyid = 12\n            },\n            {id = \"alioth_moon_1\",\n            name = \"Alioth Moon 1\",\n            radius = 30000,\n            coord = {x=457933.000,y=-1509011.000,z=115524.000},\n            system = 0,\n            bodyid = 21\n            },\n            {id = \"alioth_moon_4\",\n            name = \"Alioth Moon 4\",\n            radius = 30330,\n            coord = {x=-1692694.000,y=729681.000,z=-411464.000},\n            system = 0,\n            bodyid = 22\n            },\n            {id = \"sanctuary\",\n            name = \"Sanctuary\",\n            radius = 83400,\n            coord = {x=-1404835.000,y=562655.000,z=-285074.000},\n            system = 0,\n            bodyid = 26\n            },\n            {id = \"thades_moon_1\",\n            name = \"Thades Moon 1\",\n            radius = 14002,\n            coord = {x=29214402.000,y=10907080.695,z=433858.200},\n            system = 0,\n            bodyid = 30\n            },\n            {id = \"thades_moon_2\",\n            name = \"Thades Moon 2\",\n            radius = 15000,\n            coord = {x=29404193.000,y=10432768.000,z=19554.131},\n            system = 0,\n            bodyid = 31\n            },\n            {id = \"talemai_moon_2\",\n            name = \"Talemai Moon 2\",\n            radius = 12000,\n            coord = {x=-13503090.000,y=55594325.000,z=769838.640},\n            system = 0,\n            bodyid = 40\n            },\n            {id = \"talemai_moon_3\",\n            name = \"Talemai Moon 3\",\n            radius = 11000,\n            coord = {x=-12800515.000,y=55700259.000,z=325207.840},\n            system = 0,\n            bodyid = 41\n            },\n            {id = \"talemai_moon_1\",\n            name = \"Talemai Moon 1\",\n            radius = 15000,\n            coord = {x=-13058408.000,y=55781856.000,z=740177.760},\n            system = 0,\n            bodyid = 42\n            },\n            {id = \"feli_moon_1\",\n            name = \"Feli Moon 1\",\n            radius = 14000,\n            coord = {x=-43902841.780,y=22261034.700,z=-48862386.000},\n            system = 0,\n            bodyid = 50\n            },\n            {id = \"sinnen_moon_1\",\n            name = \"Sinnen Moon 1\",\n            radius = 17000,\n            coord = {x=58969616.000,y=29797945.000,z=57969449.000},\n            system = 0,\n            bodyid = 70\n            },\n            {id = \"lacobus\",\n            name = \"Lacobus\",\n            radius = 55650,\n            coord = {x=98865536.000,y=-13534464.000,z=-934461.990},\n            system = 0,\n            bodyid = 100\n            },\n            {id = \"lacobus_moon_3\",\n            name = \"Lacobus Moon 3\",\n            radius = 15000,\n            coord = {x=98905288.170,y=-13950921.100,z=-647589.530},\n            system = 0,\n            bodyid = 101\n            },\n            {id = \"lacobus_moon_1\",\n            name = \"Lacobus Moon 1\",\n            radius = 18000,\n            coord = {x=99180968.000,y=-13783862.000,z=-926156.400},\n            system = 0,\n            bodyid = 102\n            },\n            {id = \"lacobus_moon_2\",\n            name = \"Lacobus Moon 2\",\n            radius = 14000,\n            coord = {x=99250052.000,y=-13629215.000,z=-1059341.400},\n            system = 0,\n            bodyid = 103\n            },\n            {id = \"symeon\",\n            name = \"Symeon\",\n            radius = 49050,\n            coord = {x=14165536.000,y=-85634465.000,z=-934464.300},\n            system = 0,\n            bodyid = 110\n            },\n            {id = \"ion\",\n            name = \"Ion\",\n            radius = 44950,\n            coord = {x=2865536.700,y=-99034464.000,z=-934462.020},\n            system = 0,\n            bodyid = 120\n            },\n            {id = \"ion_moon_1\",\n            name = \"Ion Moon 1\",\n            radius = 11000,\n            coord = {x=2472916.800,y=-99133747.000,z=-1133582.800},\n            system = 0,\n            bodyid = 121\n            },\n            {id = \"ion_moon_2\",\n            name = \"Ion Moon 2\",\n            radius = 15000,\n            coord = {x=2995424.500,y=-99275010.000,z=-1378480.700},\n            system = 0,\n            bodyid = 122\n            }\n        }\n\n    end -- function planet_data()\n    planet_data()","filter":{"args":[],"signature":"start()","slotKey":"-1"},"key":"2"},{"code":"screen.clear()\nscreen.deactivate()","filter":{"args":[],"signature":"stop()","slotKey":"-1"},"key":"3"},{"code":"delay_sync = delay_sync - 1\n\nif delay_sync == 0 then\n    unit.stopTimer(\"delay\")\n    sync_data()\nend","filter":{"args":[{"value":"delay"}],"signature":"tick(timerId)","slotKey":"-1"},"key":"4"}],"methods":[],"events":[]}